(()=>{"use strict";class t{constructor(t,e,s,i,r){this.id=t,this._title=e,this._description=s,this._priority=i,this.isFinishied="true"===r}get title(){return this._title}set title(t){"string"==typeof t?this._title=t:console.error("Invalid title")}get description(){return this._description}set description(t){"string"==typeof t?this._description=t:console.error("Invalid description")}get priority(){return this._priority}set priority(t){-1<t&&t<6?this._priority=t:console.error("The priority range is out of limits, must be a value between 0 to 5")}getTaskId(){return this.id}getStatus(){return this.isFinishied}toggleTaskStatus(){this.isFinishied=!this.isFinishied}}class e{constructor(t,e,s,i){this.id=t,this._title=e,this._description=s||!1,this.date=null!=i?i:(new Date).toLocaleString(),this.tasks=[],this.idTask=0}getId(){return this.id}get title(){return this._title}set title(t){"string"==typeof t?this._title=t:console.error("Invalid title")}get description(){return this._description}set description(t){"string"==typeof t?this._description=t:console.error("Invalid description")}getDate(){return this.date}addTask(e,s,i,r){const n=new t(this.idTask,e,s,i,r);return this.idTask++,this.tasks.push(n),n}getTask(t){return this.tasks.find((e=>e.getTaskId()==t))}getAllTasks(){return this.tasks}removeTask(t){const e=this.tasks.findIndex((e=>e.getTaskId()==t));this.tasks.splice(e,1)}}const s=new class{constructor(){this.projects=[],this.idCounter=1}newProyect(t,s,i){const r=new e(this.idCounter,t,s,i);return this.projects.push(r),this.idCounter++,r}getProyect(t){return this.projects.find((e=>e.getId()==t))}getAllProjects(){return this.projects}getTask(t,e){return this.getProyect(t).getTask(e)}addTask(t,e,s,i,r){return this.getProyect(t).addTask(e,s,i,r)}changeTaskStatus(t,e){return this.getTask(t,e).toggleTaskStatus()}getTaskStatus(t,e){return this.getTask(t,e).getStatus()}changeTaskPrority(t,e,s){return this.getTask(t,e).priority=s}getTaskPriority(t,e){return this.getTask(t,e).priority}removeProyect(t){const e=this.projects.findIndex((e=>e.getId()==t));this.projects.splice(e,1)}removeTask(t,e){this.getProyect(t).removeTask(e)}getProyectsInfo(){let t="";return this.projects.forEach((e=>{t+=`⁝${e.title}§${e.description}§${e.getDate()}`,e.getAllTasks().forEach((e=>{t+=`¦${e.title}§${e.description}§${e.priority}§${e.getStatus()}`}))})),t.slice(1)}loadProyects(t){t.split(/⁝/).forEach((t=>{const e=t.split(/§|¦/);this.newProyect(e[0],this.getBoolean(e[1]),e[2]);for(let t=3;t<e.length;t+=4)this.addTask(this.idCounter-1,e[t],this.getBoolean(e[t+1]),e[t+2],e[t+3])}))}getBoolean(t){return"false"!=t&&t}},i=function(t){const e=t=>document.getElementById(t);let s=1;function i(t){const i=document.createElement("div");i.classList.add("card"),i.id=`p-${t.getId()}`,i.dataset.id=t.getId();const n=document.createElement("a"),o=document.createElement("button");o.classList.add("add-task"),o.dataset.parent=t.getId(),o.textContent="New Task",n.innerHTML+=`<h3>${t.title}</h3>`,i.innerHTML+=`<span>${t.date}</span>`,t.description&&(i.innerHTML+=`<p>${t.description}</p>`),i.prepend(n);const a=document.createElement("div");var d;a.id=`task-${t.getId()}`,a.classList.add("task","hidden"),t.tasks.forEach((t=>{r(t,a)})),i.appendChild(a),n.addEventListener("click",(e=>{e.preventDefault(),1==a.classList.length?a.classList.add("hidden"):t.tasks.length>0&&a.classList.remove("hidden")})),i.appendChild(o),o.addEventListener("click",(()=>{s=t.getId(),e("t-title").textContent=`New Task for: ${t.title}`,e("project-dialog").close(),e("task-dialog").show()})),(d="main",document.getElementsByTagName(d)[0]).appendChild(i)}function r(t,e){const s=n(e,"input","","type","checkbox");t.getStatus()&&(s.checked=!0),s.addEventListener("change",(()=>{t.toggleTaskStatus()})),n(e,"hr"),n(e,"h4",t.title),t.description&&n(e,"p",t.description)}function n(t,e,s,i,r){const n=document.createElement(e);return i&&n.setAttribute(i,r),n.textContent=s,t.appendChild(n),n}return e("add-p").addEventListener("click",(()=>{const s=t.newProyect(e("p-title").value,e("p-desc").value);i(s),scrollTo({top:e(`p-${s.getId()}`).offsetTop,behavior:"smooth"}),e("project-dialog").close()})),e("add-t").addEventListener("click",(()=>{r(t.addTask(s,e("task-title").value,e("task-desc").value,Number.parseInt(e("t-priority").value),!1),e("task-"+s)),e("task-dialog").close()})),e("new").addEventListener("click",(()=>{e("project-dialog").show(),e("task-dialog").close()})),{create:function(){t.projects.forEach((t=>i(t)))}}}(s);localStorage.getItem("projectList")&&s.loadProyects(localStorage.getItem("projectList")),i.create(),localStorage,document.getElementById("save").addEventListener("click",(()=>localStorage.setItem("projectList",s.getProyectsInfo())))})();